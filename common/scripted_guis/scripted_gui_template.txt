scripted_gui = {
    new_open_button = {
        context_type = player_context
        window_name = "new_open_button"
        #parent_window_token = politics_tab

        visible = {
            has_war = yes
        }

        effects = {
            es_open_button_bg_click = {
                if = { 
                    limit = { NOT = { has_country_flag = open_my_new_gui } } 
                    set_country_flag = open_my_new_gui
                }
                else = {
                    clr_country_flag = open_my_new_gui
                }                
            }
        }
    }

    mark_state_button = {
        context_type = selected_state_context
        window_name = "mark_state_button"
        parent_window_token = selected_state_view

        visible = {
           always = yes
        }

        triggers = {
            mark_state_button_bg_visible = {
                custom_trigger_tooltip = {
                    tooltip = CONTROLLER_HAS_WAR_WITH_ROOT
                    CONTROLLER = {
                        has_war_with = ROOT
                    }
                }
            }
            mark_state_button_bg_click_enabled = {
                custom_trigger_tooltip = {
                    tooltip = CONTROLLER_HAS_WAR_WITH_ROOT
                    CONTROLLER = {
                        has_war_with = ROOT
                    }
                }
                #hidden_trigger = {
                #    NOT = {
                #        THIS = {
                #            has_state_flag = state_marked_conquer_flag
                #        }
                #    }
                #}
            }
            marked_indicator_visible = {
                THIS = {
                    has_state_flag = state_marked_conquer_flag
                }
            }
        }
        effects = {
            mark_state_button_bg_click = {
                THIS = {
                    if = { 
                        limit = { NOT = { has_state_flag = state_marked_conquer_flag } }
                        set_state_flag = state_marked_conquer_flag
                        #set_demilitarized_zone = yes
                        ROOT = {
                            #clear_array = marked_states_array
                            add_to_array = {
                                array = marked_states_array
                                value = PREV.id
                            }
                        }        
                    }
                    else = {
                        clr_state_flag = state_marked_conquer_flag
                        #set_demilitarized_zone = no
                        ROOT = {
                            #clear_array = marked_states_array
                            remove_from_array = {
                                array = marked_states_array
                                value = PREV.id
                            }
                        }
                    }
                }
            }
        }
    }

    new_scripted_gui = {
        window_name = "new_scripted_gui_window"
        context_type = player_context
    
        visible = {
    		has_country_flag = open_my_new_gui
        }
    
        effects = {
            close_button_click = {
                clr_country_flag = open_my_new_gui
            }
            
        }
    
        triggers = {
            white_peace_checkbox_on_visible = {
                check_variable = { white_peace_check_var = 1 }
            }
    
            white_peace_checkbox_off_visible = {
                NOT = { check_variable = { white_peace_check_var = 1 } }
            }
        }
    
        dynamic_lists = {
            peace_deal_marked_states_gridbox = {
                array = marked_states_array
                entry_container = marked_states_entry
                change_scope = yes
            }
        }
    
        properties = {
            flag_list = {
                image = "[THIS.GetFlag]"
            }
        }
    
        ai_enabled = {
    		always = no
        }
    
        ai_test_interval = 290  # The higher, the long it takes the ai to do actions
    	ai_test_variance = 0.5
    
        ai_check = {
        }
    
        ai_check_scope = {
        }
    
        ai_weights = {
        }
    }
}
